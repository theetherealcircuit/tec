<div class="admin-wrapper">

    <h2>User Registrations</h2>
    <div class="tabs">
        @for (tab of statusOptions; track tab) {
        <button (click)="setTab(tab)" [class.active]="activeTab === tab">
            {{ tab }}
        </button>
        }
    </div>


    @if (usersForm) {
    <form [formGroup]="usersForm">

        <table class="user-table">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Phone</th>
                    <th>Email</th>
                    <th>Event</th>
                    <th>Date</th>
                    <th>Status</th>
                    <th>Contacted By</th>
                    <th>Feedback</th>
                    <th>Action</th>
                </tr>
            </thead>

            <tbody formArrayName="users">

                @for (user of getFilteredUsers(); track user; let i = $index) {
                <tr [formGroup]="user">

                    <td>{{ user.value.name }}</td>
                    <td>{{ user.value.phone }}</td>
                    <td>{{ user.value.email }}</td>
                    <td>{{ user.value.event }}</td>
                    <td>{{ user.value.date }}</td>

                    <td>
                        <select formControlName="status">
                            @for (s of statusOptions; track s) {
                            <option [value]="s">{{ s }}</option>
                            }
                        </select>
                    </td>

                    <td>
                        <input formControlName="contactedBy" placeholder="Admin name" />
                    </td>

                    <td>
                        <textarea formControlName="feedback"></textarea>
                    </td>

                    <td>
                        <button class="update-btn" (click)="updateUser(user)">Update</button>
                    </td>

                </tr>
                }
            </tbody>

        </table>

    </form>
    }


</div>

<iframe name="hidden_iframe" style="display:none;"></iframe>